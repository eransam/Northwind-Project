{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/erans/OneDrive/\\u05E9\\u05D5\\u05DC\\u05D7\\u05DF \\u05D4\\u05E2\\u05D1\\u05D5\\u05D3\\u05D4/\\u200F\\u200F\\u05EA\\u05D9\\u05E7\\u05D9\\u05D4 \\u05D7\\u05D3\\u05E9\\u05D4/02 - Northwind/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"C:/Users/erans/OneDrive/\\u05E9\\u05D5\\u05DC\\u05D7\\u05DF \\u05D4\\u05E2\\u05D1\\u05D5\\u05D3\\u05D4/\\u200F\\u200F\\u05EA\\u05D9\\u05E7\\u05D9\\u05D4 \\u05D7\\u05D3\\u05E9\\u05D4/02 - Northwind/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/erans/OneDrive/\\u05E9\\u05D5\\u05DC\\u05D7\\u05DF \\u05D4\\u05E2\\u05D1\\u05D5\\u05D3\\u05D4/\\u200F\\u200F\\u05EA\\u05D9\\u05E7\\u05D9\\u05D4 \\u05D7\\u05D3\\u05E9\\u05D4/02 - Northwind/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\erans\\\\OneDrive\\\\\\u05E9\\u05D5\\u05DC\\u05D7\\u05DF \\u05D4\\u05E2\\u05D1\\u05D5\\u05D3\\u05D4\\\\\\u200F\\u200F\\u05EA\\u05D9\\u05E7\\u05D9\\u05D4 \\u05D7\\u05D3\\u05E9\\u05D4\\\\02 - Northwind\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import axios from\"axios\";import{addProductAction,deleteProductAction,fetchProductsAction,updateProductAction}from\"../Redux/ProductsState\";import store from\"../Redux/Store\";import config from\"../Utils/Config\";var ProductsService=/*#__PURE__*/function(){function ProductsService(){_classCallCheck(this,ProductsService);}_createClass(ProductsService,[{key:\"fetchProducts\",value:function(){var _fetchProducts=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,products;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(store.getState().productsState.products.length===0)){_context.next=6;break;}_context.next=3;return axios.get(config.productsUrl);case 3:response=_context.sent;products=response.data;store.dispatch(fetchProductsAction(products));case 6:return _context.abrupt(\"return\",store.getState().productsState.products);case 7:case\"end\":return _context.stop();}}},_callee);}));function fetchProducts(){return _fetchProducts.apply(this,arguments);}return fetchProducts;}()},{key:\"getOneProduct\",value:function(){var _getOneProduct=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id){var product,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:product=store.getState().productsState.products.find(function(p){return p.id===id;});if(product){_context2.next=6;break;}_context2.next=4;return axios.get(config.productsUrl+id);case 4:response=_context2.sent;product=response.data;case 6:return _context2.abrupt(\"return\",product);case 7:case\"end\":return _context2.stop();}}},_callee2);}));function getOneProduct(_x){return _getOneProduct.apply(this,arguments);}return getOneProduct;}()},{key:\"deleteOneProduct\",value:function(){var _deleteOneProduct=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return axios.delete(config.productsUrl+id);case 2:store.dispatch(deleteProductAction(id));case 3:case\"end\":return _context3.stop();}}},_callee3);}));function deleteOneProduct(_x2){return _deleteOneProduct.apply(this,arguments);}return deleteOneProduct;}()},{key:\"addNewProduct\",value:function(){var _addNewProduct=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(product){var formData,response,addedProduct;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:// Convert out product to FormData:\nformData=new FormData();formData.append(\"name\",product.name);formData.append(\"price\",product.price.toString());formData.append(\"stock\",product.stock.toString());formData.append(\"image\",product.image.item(0));// Post the new product to the server: \n_context4.next=7;return axios.post(config.productsUrl,formData);case 7:response=_context4.sent;addedProduct=response.data;// Add to redux global state: \nstore.dispatch(addProductAction(addedProduct));return _context4.abrupt(\"return\",addedProduct);case 11:case\"end\":return _context4.stop();}}},_callee4);}));function addNewProduct(_x3){return _addNewProduct.apply(this,arguments);}return addNewProduct;}()},{key:\"updateProduct\",value:function(){var _updateProduct=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(product){var formData,response,updatedProduct;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:// Convert out product to FormData:\nformData=new FormData();formData.append(\"name\",product.name);formData.append(\"price\",product.price.toString());formData.append(\"stock\",product.stock.toString());formData.append(\"image\",product.image.item(0));// Put the new product to the server: \n_context5.next=7;return axios.put(config.productsUrl+product.id,formData);case 7:response=_context5.sent;updatedProduct=response.data;// Add to redux global state: \nstore.dispatch(updateProductAction(updatedProduct));return _context5.abrupt(\"return\",updatedProduct);case 11:case\"end\":return _context5.stop();}}},_callee5);}));function updateProduct(_x4){return _updateProduct.apply(this,arguments);}return updateProduct;}()}]);return ProductsService;}();var productsService=new ProductsService();export default productsService;","map":{"version":3,"sources":["C:/Users/erans/OneDrive/שולחן העבודה/‏‏תיקיה חדשה/02 - Northwind/src/Services/ProductsService.ts"],"names":["axios","addProductAction","deleteProductAction","fetchProductsAction","updateProductAction","store","config","ProductsService","getState","productsState","products","length","get","productsUrl","response","data","dispatch","id","product","find","p","delete","formData","FormData","append","name","price","toString","stock","image","item","post","addedProduct","put","updatedProduct","productsService"],"mappings":"4hCAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CAEA,OAASC,gBAAT,CAA2BC,mBAA3B,CAAgDC,mBAAhD,CAAqEC,mBAArE,KAAgG,wBAAhG,CACA,MAAOC,CAAAA,KAAP,KAAkB,gBAAlB,CACA,MAAOC,CAAAA,MAAP,KAAmB,iBAAnB,C,GAEMC,CAAAA,e,0OAEF,8JACOF,KAAK,CAACG,QAAN,GAAiBC,aAAjB,CAA+BC,QAA/B,CAAwCC,MAAxC,GAAmD,CAD1D,gDAE+BX,CAAAA,KAAK,CAACY,GAAN,CAA0BN,MAAM,CAACO,WAAjC,CAF/B,QAEcC,QAFd,eAGcJ,QAHd,CAGyBI,QAAQ,CAACC,IAHlC,CAIQV,KAAK,CAACW,QAAN,CAAeb,mBAAmB,CAACO,QAAD,CAAlC,EAJR,uCAMWL,KAAK,CAACG,QAAN,GAAiBC,aAAjB,CAA+BC,QAN1C,wD,oNASA,kBAA2BO,EAA3B,2IACQC,OADR,CACkBb,KAAK,CAACG,QAAN,GAAiBC,aAAjB,CAA+BC,QAA/B,CAAwCS,IAAxC,CAA6C,SAAAC,CAAC,QAAIA,CAAAA,CAAC,CAACH,EAAF,GAASA,EAAb,EAA9C,CADlB,IAEQC,OAFR,iDAG+BlB,CAAAA,KAAK,CAACY,GAAN,CAAwBN,MAAM,CAACO,WAAP,CAAqBI,EAA7C,CAH/B,QAGcH,QAHd,gBAIQI,OAAO,CAAGJ,QAAQ,CAACC,IAAnB,CAJR,wCAMWG,OANX,0D,4NASA,kBAA8BD,EAA9B,6IACUjB,CAAAA,KAAK,CAACqB,MAAN,CAAaf,MAAM,CAACO,WAAP,CAAqBI,EAAlC,CADV,QAEIZ,KAAK,CAACW,QAAN,CAAed,mBAAmB,CAACe,EAAD,CAAlC,EAFJ,wD,gOAKA,kBAA2BC,OAA3B,yJAEI;AACMI,QAHV,CAGqB,GAAIC,CAAAA,QAAJ,EAHrB,CAIID,QAAQ,CAACE,MAAT,CAAgB,MAAhB,CAAwBN,OAAO,CAACO,IAAhC,EACAH,QAAQ,CAACE,MAAT,CAAgB,OAAhB,CAAyBN,OAAO,CAACQ,KAAR,CAAcC,QAAd,EAAzB,EACAL,QAAQ,CAACE,MAAT,CAAgB,OAAhB,CAAyBN,OAAO,CAACU,KAAR,CAAcD,QAAd,EAAzB,EACAL,QAAQ,CAACE,MAAT,CAAgB,OAAhB,CAAyBN,OAAO,CAACW,KAAR,CAAcC,IAAd,CAAmB,CAAnB,CAAzB,EAEA;AATJ,uBAU2B9B,CAAAA,KAAK,CAAC+B,IAAN,CAAyBzB,MAAM,CAACO,WAAhC,CAA6CS,QAA7C,CAV3B,QAUUR,QAVV,gBAWUkB,YAXV,CAWyBlB,QAAQ,CAACC,IAXlC,CAaI;AACAV,KAAK,CAACW,QAAN,CAAef,gBAAgB,CAAC+B,YAAD,CAA/B,EAdJ,iCAgBWA,YAhBX,2D,uNAmBA,kBAA2Bd,OAA3B,2JAEI;AACMI,QAHV,CAGqB,GAAIC,CAAAA,QAAJ,EAHrB,CAIID,QAAQ,CAACE,MAAT,CAAgB,MAAhB,CAAwBN,OAAO,CAACO,IAAhC,EACAH,QAAQ,CAACE,MAAT,CAAgB,OAAhB,CAAyBN,OAAO,CAACQ,KAAR,CAAcC,QAAd,EAAzB,EACAL,QAAQ,CAACE,MAAT,CAAgB,OAAhB,CAAyBN,OAAO,CAACU,KAAR,CAAcD,QAAd,EAAzB,EACAL,QAAQ,CAACE,MAAT,CAAgB,OAAhB,CAAyBN,OAAO,CAACW,KAAR,CAAcC,IAAd,CAAmB,CAAnB,CAAzB,EAEA;AATJ,uBAU2B9B,CAAAA,KAAK,CAACiC,GAAN,CAAwB3B,MAAM,CAACO,WAAP,CAAqBK,OAAO,CAACD,EAArD,CAAyDK,QAAzD,CAV3B,QAUUR,QAVV,gBAWUoB,cAXV,CAW2BpB,QAAQ,CAACC,IAXpC,CAaI;AACAV,KAAK,CAACW,QAAN,CAAeZ,mBAAmB,CAAC8B,cAAD,CAAlC,EAdJ,iCAgBWA,cAhBX,2D,mIAqBJ,GAAMC,CAAAA,eAAe,CAAG,GAAI5B,CAAAA,eAAJ,EAAxB,CAEA,cAAe4B,CAAAA,eAAf","sourcesContent":["import axios from \"axios\";\r\nimport ProductModel from \"../Models/ProductModel\";\r\nimport { addProductAction, deleteProductAction, fetchProductsAction, updateProductAction } from \"../Redux/ProductsState\";\r\nimport store from \"../Redux/Store\";\r\nimport config from \"../Utils/Config\";\r\n\r\nclass ProductsService {\r\n\r\n    public async fetchProducts(): Promise<ProductModel[]> {\r\n        if(store.getState().productsState.products.length === 0) {\r\n            const response = await axios.get<ProductModel[]>(config.productsUrl);\r\n            const products = response.data;\r\n            store.dispatch(fetchProductsAction(products));\r\n        }\r\n        return store.getState().productsState.products;\r\n    }\r\n\r\n    public async getOneProduct(id: number): Promise<ProductModel> {\r\n        let product = store.getState().productsState.products.find(p => p.id === id);\r\n        if(!product) {\r\n            const response = await axios.get<ProductModel>(config.productsUrl + id);\r\n            product = response.data;\r\n        }\r\n        return product;\r\n    }\r\n\r\n    public async deleteOneProduct(id: number): Promise<void> {\r\n        await axios.delete(config.productsUrl + id);\r\n        store.dispatch(deleteProductAction(id));\r\n    }\r\n\r\n    public async addNewProduct(product: ProductModel): Promise<ProductModel> {\r\n\r\n        // Convert out product to FormData:\r\n        const formData = new FormData();\r\n        formData.append(\"name\", product.name);\r\n        formData.append(\"price\", product.price.toString());\r\n        formData.append(\"stock\", product.stock.toString());\r\n        formData.append(\"image\", product.image.item(0));\r\n\r\n        // Post the new product to the server: \r\n        const response = await axios.post<ProductModel>(config.productsUrl, formData);\r\n        const addedProduct = response.data;\r\n\r\n        // Add to redux global state: \r\n        store.dispatch(addProductAction(addedProduct));\r\n\r\n        return addedProduct;\r\n    }\r\n\r\n    public async updateProduct(product: ProductModel): Promise<ProductModel> {\r\n\r\n        // Convert out product to FormData:\r\n        const formData = new FormData();\r\n        formData.append(\"name\", product.name);\r\n        formData.append(\"price\", product.price.toString());\r\n        formData.append(\"stock\", product.stock.toString());\r\n        formData.append(\"image\", product.image.item(0));\r\n\r\n        // Put the new product to the server: \r\n        const response = await axios.put<ProductModel>(config.productsUrl + product.id, formData);\r\n        const updatedProduct = response.data;\r\n\r\n        // Add to redux global state: \r\n        store.dispatch(updateProductAction(updatedProduct));\r\n\r\n        return updatedProduct;\r\n    }\r\n    \r\n}\r\n\r\nconst productsService = new ProductsService();\r\n\r\nexport default productsService;"]},"metadata":{},"sourceType":"module"}