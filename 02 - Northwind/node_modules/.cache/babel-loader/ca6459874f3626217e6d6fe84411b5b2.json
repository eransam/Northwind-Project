{"ast":null,"code":"import _objectSpread from\"C:/Users/erans/OneDrive/\\u05E9\\u05D5\\u05DC\\u05D7\\u05DF \\u05D4\\u05E2\\u05D1\\u05D5\\u05D3\\u05D4/\\u200F\\u200F\\u05EA\\u05D9\\u05E7\\u05D9\\u05D4 \\u05D7\\u05D3\\u05E9\\u05D4/02 - Northwind/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _createClass from\"C:/Users/erans/OneDrive/\\u05E9\\u05D5\\u05DC\\u05D7\\u05DF \\u05D4\\u05E2\\u05D1\\u05D5\\u05D3\\u05D4/\\u200F\\u200F\\u05EA\\u05D9\\u05E7\\u05D9\\u05D4 \\u05D7\\u05D3\\u05E9\\u05D4/02 - Northwind/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _classCallCheck from\"C:/Users/erans/OneDrive/\\u05E9\\u05D5\\u05DC\\u05D7\\u05DF \\u05D4\\u05E2\\u05D1\\u05D5\\u05D3\\u05D4/\\u200F\\u200F\\u05EA\\u05D9\\u05E7\\u05D9\\u05D4 \\u05D7\\u05D3\\u05E9\\u05D4/02 - Northwind/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import jwtDecode from\"jwt-decode\";// State\nexport var AuthState=/*#__PURE__*/_createClass(function AuthState(){_classCallCheck(this,AuthState);this.user=null;this.token=null;this.token=localStorage.getItem(\"token\");if(this.token){var encodedObject=jwtDecode(this.token);this.user=encodedObject.user;}});// Action Type\nexport var AuthActionType;// Action\n(function(AuthActionType){AuthActionType[\"Register\"]=\"Register\";AuthActionType[\"Login\"]=\"Login\";AuthActionType[\"Logout\"]=\"Logout\";})(AuthActionType||(AuthActionType={}));// Action Creators: \nexport function registerAction(token){return{type:AuthActionType.Register,payload:token};}export function loginAction(token){return{type:AuthActionType.Login,payload:token};}export function logoutAction(){return{type:AuthActionType.Logout};}// Reducer: \nexport function authReducer(){var currentState=arguments.length>0&&arguments[0]!==undefined?arguments[0]:new AuthState();var action=arguments.length>1?arguments[1]:undefined;var newState=_objectSpread({},currentState);switch(action.type){case AuthActionType.Register:case AuthActionType.Login:newState.token=action.payload;// Here the payload is the token sent from the backend.\nvar encodedObject=jwtDecode(newState.token);// Convert to any for getting the inside \"user\" object.\nnewState.user=encodedObject.user;localStorage.setItem(\"token\",newState.token);break;case AuthActionType.Logout:newState.token=null;newState.user=null;localStorage.removeItem(\"token\");break;}return newState;}","map":{"version":3,"sources":["C:/Users/erans/OneDrive/שולחן העבודה/‏‏תיקיה חדשה/02 - Northwind/src/Redux/AuthState.ts"],"names":["jwtDecode","AuthState","user","token","localStorage","getItem","encodedObject","AuthActionType","registerAction","type","Register","payload","loginAction","Login","logoutAction","Logout","authReducer","currentState","action","newState","setItem","removeItem"],"mappings":"ywBAAA,MAAOA,CAAAA,SAAP,KAAsB,YAAtB,CAGA;AACA,UAAaC,CAAAA,SAAb,2BAKI,oBAAqB,sCAHdC,IAGc,CAHI,IAGJ,MAFdC,KAEc,CAFE,IAEF,CACjB,KAAKA,KAAL,CAAaC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAb,CACA,GAAG,KAAKF,KAAR,CAAe,CACX,GAAMG,CAAAA,aAAkB,CAAGN,SAAS,CAAC,KAAKG,KAAN,CAApC,CACA,KAAKD,IAAL,CAAYI,aAAa,CAACJ,IAA1B,CACH,CACJ,CAXL,EAeA;AACA,UAAYK,CAAAA,cAAZ,CAMA;UANYA,c,EAAAA,c,wBAAAA,c,kBAAAA,c,uBAAAA,c,GAAAA,c,MAYZ;AACA,MAAO,SAASC,CAAAA,cAAT,CAAwBL,KAAxB,CAAmD,CACtD,MAAO,CAAEM,IAAI,CAAEF,cAAc,CAACG,QAAvB,CAAiCC,OAAO,CAAER,KAA1C,CAAP,CACH,CACD,MAAO,SAASS,CAAAA,WAAT,CAAqBT,KAArB,CAAgD,CACnD,MAAO,CAAEM,IAAI,CAAEF,cAAc,CAACM,KAAvB,CAA8BF,OAAO,CAAER,KAAvC,CAAP,CACH,CACD,MAAO,SAASW,CAAAA,YAAT,EAAoC,CACvC,MAAO,CAAEL,IAAI,CAAEF,cAAc,CAACQ,MAAvB,CAAP,CACH,CAED;AACA,MAAO,SAASC,CAAAA,WAAT,EAAoF,IAA/DC,CAAAA,YAA+D,2DAAhD,GAAIhB,CAAAA,SAAJ,EAAgD,IAA/BiB,CAAAA,MAA+B,2CAEvF,GAAMC,CAAAA,QAAQ,kBAAQF,YAAR,CAAd,CAEA,OAAQC,MAAM,CAACT,IAAf,EACI,IAAKF,CAAAA,cAAc,CAACG,QAApB,CACA,IAAKH,CAAAA,cAAc,CAACM,KAApB,CACIM,QAAQ,CAAChB,KAAT,CAAiBe,MAAM,CAACP,OAAxB,CAAiC;AACjC,GAAML,CAAAA,aAAkB,CAAGN,SAAS,CAACmB,QAAQ,CAAChB,KAAV,CAApC,CAAsD;AACtDgB,QAAQ,CAACjB,IAAT,CAAgBI,aAAa,CAACJ,IAA9B,CACAE,YAAY,CAACgB,OAAb,CAAqB,OAArB,CAA8BD,QAAQ,CAAChB,KAAvC,EACA,MACJ,IAAKI,CAAAA,cAAc,CAACQ,MAApB,CACII,QAAQ,CAAChB,KAAT,CAAiB,IAAjB,CACAgB,QAAQ,CAACjB,IAAT,CAAgB,IAAhB,CACAE,YAAY,CAACiB,UAAb,CAAwB,OAAxB,EACA,MAZR,CAeA,MAAOF,CAAAA,QAAP,CACH","sourcesContent":["import jwtDecode from \"jwt-decode\";\r\nimport UserModel from \"../Models/UserModel\";\r\n\r\n// State\r\nexport class AuthState {\r\n\r\n    public user: UserModel = null;\r\n    public token: string = null;\r\n\r\n    public constructor() {\r\n        this.token = localStorage.getItem(\"token\");\r\n        if(this.token) {\r\n            const encodedObject: any = jwtDecode(this.token);\r\n            this.user = encodedObject.user;\r\n        }\r\n    }\r\n    \r\n}\r\n\r\n// Action Type\r\nexport enum AuthActionType {\r\n    Register = \"Register\",\r\n    Login = \"Login\",\r\n    Logout = \"Logout\"\r\n}\r\n\r\n// Action\r\nexport interface AuthAction {\r\n    type: AuthActionType;\r\n    payload?: string; // Optional (on Logout we don't need to supply a payload)\r\n}\r\n\r\n// Action Creators: \r\nexport function registerAction(token: string): AuthAction {\r\n    return { type: AuthActionType.Register, payload: token };\r\n}\r\nexport function loginAction(token: string): AuthAction {\r\n    return { type: AuthActionType.Login, payload: token };\r\n}\r\nexport function logoutAction(): AuthAction {\r\n    return { type: AuthActionType.Logout };\r\n}\r\n\r\n// Reducer: \r\nexport function authReducer(currentState = new AuthState(), action: AuthAction): AuthState {\r\n\r\n    const newState = { ...currentState };\r\n\r\n    switch (action.type) {\r\n        case AuthActionType.Register:\r\n        case AuthActionType.Login:\r\n            newState.token = action.payload; // Here the payload is the token sent from the backend.\r\n            const encodedObject: any = jwtDecode(newState.token); // Convert to any for getting the inside \"user\" object.\r\n            newState.user = encodedObject.user;\r\n            localStorage.setItem(\"token\", newState.token);\r\n            break;\r\n        case AuthActionType.Logout:\r\n            newState.token = null;\r\n            newState.user = null;\r\n            localStorage.removeItem(\"token\");\r\n            break;\r\n    }\r\n\r\n    return newState;\r\n}"]},"metadata":{},"sourceType":"module"}